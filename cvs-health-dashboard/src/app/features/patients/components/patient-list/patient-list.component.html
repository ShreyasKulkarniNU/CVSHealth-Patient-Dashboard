<div class="patient-database-page">
  <div class="page-header">
    <h2 class="section-title">PATIENT DATABASE</h2>
    <button class="btn-add-patient" (click)="addNewPatient()">
      ADD NEW PATIENT
    </button>
  </div>

  <!-- Filter Buttons -->
  <div class="filter-buttons">
    <select class="filter-select" (change)="onDoctorFilterChange($any($event.target).value)">
      <option value="">Filter by Doctor</option>
      @for (doctor of doctors(); track doctor) {
        <option [value]="doctor">{{ doctor }}</option>
      }
    </select>
    <button class="filter-btn">Filters ‚ñº</button>
  </div>

  <!-- Search Bar -->
  <div class="search-section">
    <div class="search-input-wrapper">
      <span class="search-icon">üîç</span>
      <input 
        type="text" 
        class="search-input"
        placeholder="Search by name, ID, or condition"
        [value]="searchQuery()"
        (input)="searchQuery.set($any($event.target).value)"
        (keyup.enter)="onSearch()"
      />
    </div>
  </div>

  <!-- Secondary Filter Tabs -->
  <div class="filter-tabs">
    <button 
      class="filter-tab"
      [class.active]="activeFilter() === 'all'"
      (click)="onFilterChange('all')">
      All Patients
    </button>
    <button 
      class="filter-tab"
      [class.active]="activeFilter() === 'active'"
      (click)="onFilterChange('active')">
      Active
    </button>
    <button 
      class="filter-tab"
      [class.active]="activeFilter() === 'inactive'"
      (click)="onFilterChange('inactive')">
      Inactive
    </button>
    <button 
      class="filter-tab"
      [class.active]="activeFilter() === 'pending'"
      (click)="onFilterChange('pending')">
      Pending
    </button>
  </div>

  <!-- Patient Table -->
  @if (loading()) {
    <div class="loading">Loading patients...</div>
  } @else {
    <div class="table-container">
      <table class="patient-table">
        <thead>
          <tr>
            <th>NAME</th>
            <th>PATIENT ID</th>
            <th>PRIMARY DOCTOR</th>
            <th>LAST VISIT</th>
            <th>NEXT APPOINTMENT</th>
            <th>STATUS</th>
          </tr>
        </thead>
        <tbody>
          @for (patient of filteredPatients(); track patient.id) {
            <tr class="patient-row" (click)="selectPatient(patient)">
              <td>
                <div class="patient-name">
                  <span class="patient-icon">+</span>
                  {{ patient.firstName }} {{ patient.lastName }}
                </div>
              </td>
              <td>{{ patient.id }}</td>
              <td>{{ patient.primaryPhysician }}</td>
              <td>{{ patient.lastVisit | date:'MMM d, yyyy' }}</td>
              <td>{{ patient.nextAppointment | date:'MMM d, yyyy' }}</td>
              <td>
                <span class="status-badge" [class.active]="patient.status === 'active'">
                  {{ patient.status | titlecase }}
                </span>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</div>

